(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[480],{630:e=>{function s(e){var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}s.keys=()=>[],s.resolve=s,s.id=630,e.exports=s},1539:(e,s,r)=>{Promise.resolve().then(r.bind(r,7065))},3999:(e,s,r)=>{"use strict";r.d(s,{cn:()=>n});var t=r(2596),a=r(9688);function n(){for(var e=arguments.length,s=Array(e),r=0;r<e;r++)s[r]=arguments[r];return(0,a.QP)((0,t.$)(s))}},5638:()=>{},6403:()=>{},7065:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>y});var t=r(5155),a=r(2115),n=r(7168),o=r(8482),i=r(8145),c=r(4213),l=r(646),d=r(4861),u=r(3904),m=r(5021),h=r(2657);throw r(7405),r(9509),Error("MySQL connection cannot be used on client side");async function x(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{let[r]=await mysqlPool.execute(e,s);return{data:r,error:null}}catch(e){return console.error("Query execution error:",e),{data:null,error:e}}}async function f(e){try{let s={customer_name:e.customerName,customer_address:e.customerAddress,branch_name:e.branchName,project_name:e.projectName,location:e.location,location_data:JSON.stringify(e.locationData),unique_id:e.uniqueId,phone:e.phone,email:e.email,other_info:e.otherInfo,standard:e.standard,classification:e.classification,system:e.system,ac_system:e.acSystem,ventilation_system:e.ventilationSystem,cooling_method:e.coolingMethod,ventilation_type:e.ventilationType,max_temp:e.maxTemp,min_temp:e.minTemp,max_rh:e.maxRh,min_rh:e.minRh,air_changes:e.airChanges||"",filters:JSON.stringify(e.filters||{}),ahu_specs:JSON.stringify(e.ahuSpecs||[]),filtration_stages:e.filtrationStages||"",static_pressure:e.staticPressure||"",pressure_drop:JSON.stringify(e.pressureDrop||[])},r=[s.customer_name,s.customer_address,s.branch_name,s.project_name,s.location,s.location_data,s.unique_id,s.phone,s.email,s.other_info,s.standard,s.classification,s.system,s.ac_system,s.ventilation_system,s.cooling_method,s.ventilation_type,s.max_temp,s.min_temp,s.max_rh,s.min_rh,s.air_changes,s.filters,s.ahu_specs,s.filtration_stages,s.static_pressure,s.pressure_drop],t=await x("\n      INSERT INTO form_submissions (\n        customer_name, customer_address, branch_name, project_name, location,\n        location_data, unique_id, phone, email, other_info, standard,\n        classification, system, ac_system, ventilation_system, cooling_method,\n        ventilation_type, max_temp, min_temp, max_rh, min_rh, air_changes,\n        filters, ahu_specs, filtration_stages, static_pressure, pressure_drop\n      ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n    ",r);if(t.error)return console.error("Error saving form submission:",t.error),{error:t.error};let a=await x("SELECT * FROM form_submissions WHERE unique_id = ?",[e.uniqueId]);if(a.error)return{error:a.error};let n=a.data,o=null==n?void 0:n[0];if(o)return{data:{...o,location_data:o.location_data?JSON.parse(o.location_data):null,filters:o.filters?JSON.parse(o.filters):null,ahu_specs:o.ahu_specs?JSON.parse(o.ahu_specs):null,pressure_drop:o.pressure_drop?JSON.parse(o.pressure_drop):null}};return{data:s}}catch(e){return console.error("Error in saveFormSubmission:",e),{error:e}}}async function p(){try{let e=await x("SELECT * FROM form_submissions ORDER BY created_at DESC");if(e.error)return console.error("Error fetching form submissions:",e.error),{error:e.error};return{data:e.data.map(e=>({...e,location_data:e.location_data?JSON.parse(e.location_data):null,filters:e.filters?JSON.parse(e.filters):null,ahu_specs:e.ahu_specs?JSON.parse(e.ahu_specs):null,pressure_drop:e.pressure_drop?JSON.parse(e.pressure_drop):null}))}}catch(e){return console.error("Error in getFormSubmissions:",e),{error:e}}}async function _(){try{var e,s;console.log("\uD83D\uDD0D Testing MySQL connection...");let r=await x("SELECT COUNT(*) as count FROM form_submissions");if(r.error)return console.error("❌ Database connection failed:",r.error),{success:!1,error:r.error};console.log("✅ Database connection successful!");let t=(null===(s=r.data)||void 0===s?void 0:null===(e=s[0])||void 0===e?void 0:e.count)||0;return console.log("\uD83D\uDCCA Total records in form_submissions:",t),{success:!0,count:t}}catch(e){return console.error("❌ Unexpected error:",e),{success:!1,error:e}}}async function v(){let e={customerName:"Test Customer",customerAddress:"123 Test Street, Test City",branchName:"Test Branch",projectName:"Test Project",location:"Test Location",locationData:{lat:40.7128,lng:-74.006,address:"New York, NY"},uniqueId:"TEST-".concat(Date.now()),phone:"+1234567890",email:"test@example.com",otherInfo:"This is a test submission",standard:"TGA",classification:"3500 K",system:"Air-Conditioning System",acSystem:"Clean Room Air-Conditioning",ventilationSystem:"",coolingMethod:"Chilled Water",ventilationType:"",maxTemp:"35",minTemp:"15",maxRh:"60",minRh:"45",airChanges:"20",filters:{"10 M Supply":!0,"5 M Supply":!0},ahuSpecs:["25mm Thick Panel & AL Profile"],filtrationStages:"2",staticPressure:"150",pressureDrop:[]};try{console.log("\uD83E\uDDEA Testing form save...");let s=await f(e);if(s.error)return console.error("❌ Save failed:",s.error),{success:!1,error:s.error};return console.log("✅ Form saved successfully:",s.data),{success:!0,data:s.data}}catch(e){return console.error("❌ Unexpected save error:",e),{success:!1,error:e}}}async function g(){try{var e,s;console.log("\uD83D\uDCCB Testing form retrieval...");let r=await p();if(r.error)return console.error("❌ Retrieval failed:",r.error),{success:!1,error:r.error};return console.log("✅ Forms retrieved successfully:"),console.log("\uD83D\uDCCA Found ".concat((null===(e=r.data)||void 0===e?void 0:e.length)||0," form submissions")),console.table(null===(s=r.data)||void 0===s?void 0:s.map(e=>({id:e.id,unique_id:e.unique_id,customer_name:e.customer_name,project_name:e.project_name,created_at:e.created_at}))),{success:!0,data:r.data}}catch(e){return console.error("❌ Unexpected retrieval error:",e),{success:!1,error:e}}}async function b(){console.log("\uD83D\uDE80 Starting database tests...\n");let e=await _();if(console.log("\n"+"=".repeat(50)+"\n"),!e.success)return console.log("❌ Connection failed, skipping other tests"),{connection:!1,save:!1,retrieve:!1};{let s=await v();console.log("\n"+"=".repeat(50)+"\n");let r=await g();return console.log("\n"+"=".repeat(50)+"\n"),console.log("\uD83C\uDF89 All database tests completed!"),{connection:e.success,save:s.success,retrieve:r.success}}}function y(){let[e,s]=(0,a.useState)(!1),[r,x]=(0,a.useState)(null),[f,v]=(0,a.useState)([]),[g,y]=(0,a.useState)("idle"),j=async()=>{s(!0);try{let e=await b();x(e),e.connection?y("success"):y("error")}catch(e){console.error("Test failed:",e),y("error")}finally{s(!1)}},N=async()=>{s(!0);try{let e=await p();e.data?(v(e.data),y("success")):y("error")}catch(e){console.error("Failed to load submissions:",e),y("error")}finally{s(!1)}},S=async()=>{s(!0);try{(await _()).success?y("success"):y("error")}catch(e){y("error")}finally{s(!1)}};return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,t.jsxs)("div",{className:"mx-auto max-w-6xl",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:[(0,t.jsx)(c.A,{className:"inline-block mr-3 h-8 w-8"}),"Database Testing & Management"]}),(0,t.jsx)("p",{className:"text-gray-600",children:"Test your Supabase database connection and view form submissions"})]}),(0,t.jsxs)(o.Zp,{className:"mb-6",children:[(0,t.jsx)(o.aR,{children:(0,t.jsxs)(o.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(c.A,{className:"h-5 w-5"}),"Database Connection Status","success"===g&&(0,t.jsx)(l.A,{className:"h-5 w-5 text-green-500"}),"error"===g&&(0,t.jsx)(d.A,{className:"h-5 w-5 text-red-500"})]})}),(0,t.jsxs)(o.Wu,{children:[(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsxs)(n.$,{onClick:S,disabled:e,variant:"outline",children:[e?(0,t.jsx)(u.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,t.jsx)(c.A,{className:"h-4 w-4 mr-2"}),"Test Connection"]}),(0,t.jsxs)(n.$,{onClick:j,disabled:e,children:[e?(0,t.jsx)(u.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,t.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Run Full Database Tests"]}),(0,t.jsxs)(n.$,{onClick:N,disabled:e,variant:"secondary",children:[e?(0,t.jsx)(u.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,t.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"View All Submissions"]})]}),"idle"!==g&&(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(i.E,{variant:"success"===g?"default":"destructive",className:"text-sm",children:"success"===g?"✅ Database Connected":"❌ Connection Failed"})})]})]}),r&&(0,t.jsxs)(o.Zp,{className:"mb-6",children:[(0,t.jsx)(o.aR,{children:(0,t.jsx)(o.ZB,{children:"Test Results"})}),(0,t.jsx)(o.Wu,{children:(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl mb-2",children:r.connection?"✅":"❌"}),(0,t.jsx)("div",{className:"font-semibold",children:"Connection"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl mb-2",children:r.save?"✅":"❌"}),(0,t.jsx)("div",{className:"font-semibold",children:"Save Data"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl mb-2",children:r.retrieve?"✅":"❌"}),(0,t.jsx)("div",{className:"font-semibold",children:"Retrieve Data"})]})]})})]}),f.length>0&&(0,t.jsxs)(o.Zp,{children:[(0,t.jsx)(o.aR,{children:(0,t.jsxs)(o.ZB,{children:["Form Submissions (",f.length,")"]})}),(0,t.jsx)(o.Wu,{children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("th",{className:"text-left p-2",children:"Unique ID"}),(0,t.jsx)("th",{className:"text-left p-2",children:"Customer"}),(0,t.jsx)("th",{className:"text-left p-2",children:"Project"}),(0,t.jsx)("th",{className:"text-left p-2",children:"System"}),(0,t.jsx)("th",{className:"text-left p-2",children:"Created"})]})}),(0,t.jsx)("tbody",{children:f.map(e=>(0,t.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"p-2 font-mono text-xs",children:e.unique_id}),(0,t.jsx)("td",{className:"p-2",children:e.customer_name}),(0,t.jsx)("td",{className:"p-2",children:e.project_name}),(0,t.jsx)("td",{className:"p-2",children:(0,t.jsx)(i.E,{variant:"outline",children:e.system})}),(0,t.jsx)("td",{className:"p-2 text-gray-500",children:new Date(e.created_at||"").toLocaleDateString()})]},e.id))})]})})})]}),(0,t.jsxs)(o.Zp,{className:"mt-6",children:[(0,t.jsx)(o.aR,{children:(0,t.jsx)(o.ZB,{children:"Database Access Instructions"})}),(0,t.jsxs)(o.Wu,{className:"prose prose-sm max-w-none",children:[(0,t.jsx)("h4",{children:"1. Supabase Dashboard (Web Interface)"}),(0,t.jsxs)("ul",{children:[(0,t.jsxs)("li",{children:["Go to: ",(0,t.jsx)("a",{href:"/mysql-test",target:"_blank",className:"text-blue-600 hover:underline",children:"MySQL Database Test"})]}),(0,t.jsx)("li",{children:'Navigate to "Table Editor" to see your data'}),(0,t.jsx)("li",{children:'Use "SQL Editor" to run custom queries'})]}),(0,t.jsx)("h4",{children:"2. Direct Database Query"}),(0,t.jsx)("p",{children:"Use the SQL Editor in Supabase to run queries like:"}),(0,t.jsx)("code",{className:"block bg-gray-100 p-2 rounded text-xs",children:"SELECT * FROM form_submissions ORDER BY created_at DESC;"}),(0,t.jsx)("h4",{children:"3. Environment Check"}),(0,t.jsx)("p",{children:"Make sure your .env.local file contains:"}),(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"NEXT_PUBLIC_SUPABASE_URL"}),(0,t.jsx)("li",{children:"NEXT_PUBLIC_SUPABASE_API_KEY"}),(0,t.jsx)("li",{children:"SUPABASE_URL"}),(0,t.jsx)("li",{children:"SUPABASE_API_KEY"})]})]})]})]})})}},7168:(e,s,r)=>{"use strict";r.d(s,{$:()=>l});var t=r(5155),a=r(2115),n=r(9708),o=r(2085),i=r(3999);let c=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=a.forwardRef((e,s)=>{let{className:r,variant:a,size:o,asChild:l=!1,...d}=e,u=l?n.DX:"button";return(0,t.jsx)(u,{className:(0,i.cn)(c({variant:a,size:o,className:r})),ref:s,...d})});l.displayName="Button"},7316:()=>{},8145:(e,s,r)=>{"use strict";r.d(s,{E:()=>i});var t=r(5155);r(2115);var a=r(2085),n=r(3999);let o=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:s,variant:r,...a}=e;return(0,t.jsx)("div",{className:(0,n.cn)(o({variant:r}),s),...a})}},8482:(e,s,r)=>{"use strict";r.d(s,{Wu:()=>l,ZB:()=>c,Zp:()=>o,aR:()=>i});var t=r(5155),a=r(2115),n=r(3999);let o=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});o.displayName="Card";let i=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...a})});i.displayName="CardHeader";let c=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});c.displayName="CardTitle",a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",r),...a})}).displayName="CardDescription";let l=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",r),...a})});l.displayName="CardContent",a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",r),...a})}).displayName="CardFooter"}},e=>{var s=s=>e(e.s=s);e.O(0,[370,268,238,455,69,441,684,358],()=>s(1539)),_N_E=e.O()}]);